# üì¶ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –±—ç–∫–∞–ø—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö MongoDB

## üéØ –ì–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö?

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** –õ–æ–∫–∞–ª—å–Ω–∞—è MongoDB –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ  
**Connection String:** `mongodb://localhost:27017/rudn_schedule`  
**–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** `rudn_schedule`  
**–ö–æ–ª–ª–µ–∫—Ü–∏–π:** 7 (user_settings, user_stats, user_achievements, tasks, rooms, room_participants, group_tasks)

---

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (3 –ø—Ä–æ—Å—Ç—ã—Ö —à–∞–≥–∞)

### –®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø
```bash
./download_backup.sh
```

### –®–∞–≥ 2: –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
```bash
ls -lh /app/api_backups/
```

### –®–∞–≥ 3: –°–∫–∞—á–∞—Ç—å –Ω–∞ —Å–≤–æ–π –∫–æ–º–ø—å—é—Ç–µ—Ä
```bash
cat /app/api_backups/database_backup_*.json | base64
```
*(–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤—ã–≤–æ–¥ –∏ –¥–µ–∫–æ–¥–∏—Ä—É–π—Ç–µ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º –ü–ö)*

**–ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ:**
```bash
# Linux/Mac
cat copied_text.txt | base64 -d > backup.json

# Windows PowerShell
[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String((Get-Content copied_text.txt))) | Set-Content backup.json
```

---

## üõ†Ô∏è –î–æ—Å—Ç—É–ø–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

### 1Ô∏è‚É£ API —ç–∫—Å–ø–æ—Ä—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤)
```bash
./download_backup.sh
```
- ‚úÖ –°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π
- ‚úÖ JSON —Ñ–æ—Ä–º–∞—Ç (—á–∏—Ç–∞–µ–º—ã–π)
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ REST API
- üìÅ –†–µ–∑—É–ª—å—Ç–∞—Ç: `/app/api_backups/`

### 2Ô∏è‚É£ –ü–æ–ª–Ω—ã–π MongoDB –±—ç–∫–∞–ø (–¥–ª—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–æ–≤)
```bash
./backup_mongodb.sh
```
- ‚úÖ –ë–∏–Ω–∞—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç MongoDB
- ‚úÖ –ë—ã—Å—Ç—Ä–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
- ‚úÖ JSON –∫–æ–ø–∏—è
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞—Ä—Ö–∏–≤ tar.gz
- üìÅ –†–µ–∑—É–ª—å—Ç–∞—Ç: `/app/backups/`

### 3Ô∏è‚É£ –ë—ã—Å—Ç—Ä—ã–π JSON —ç–∫—Å–ø–æ—Ä—Ç
```bash
./export_json.sh
```
- ‚úÖ –°–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π
- ‚úÖ –û—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –∫–∞–∂–¥–æ–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏
- üìÅ –†–µ–∑—É–ª—å—Ç–∞—Ç: `/app/exports/`

### 4Ô∏è‚É£ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
```bash
./restore_mongodb.sh /path/to/backup
```
‚ö†Ô∏è –≠—Ç–æ –ø–µ—Ä–µ–∑–∞–ø–∏—à–µ—Ç —Ç–µ–∫—É—â—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö!

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| **[BACKUP_CHEATSHEET.md](./BACKUP_CHEATSHEET.md)** | üöÄ –ë—ã—Å—Ç—Ä–∞—è —à–ø–∞—Ä–≥–∞–ª–∫–∞ —Å –∫–æ–º–∞–Ω–¥–∞–º–∏ |
| **[README_BACKUP.md](./README_BACKUP.md)** | üìñ –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ (–≤—Å–µ —Å–ø–æ—Å–æ–±—ã) |
| **[BACKUP_INSTRUCTIONS.md](./BACKUP_INSTRUCTIONS.md)** | üìã –î–µ—Ç–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ |

---

## üîß –°–∫—Ä–∏–ø—Ç—ã

| –°–∫—Ä–∏–ø—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|--------|------------|
| `./download_backup.sh` | API —ç–∫—Å–ø–æ—Ä—Ç (JSON) |
| `./backup_mongodb.sh` | –ü–æ–ª–Ω—ã–π –±—ç–∫–∞–ø (binary + JSON + archive) |
| `./export_json.sh` | –ë—ã—Å—Ç—Ä—ã–π JSON —ç–∫—Å–ø–æ—Ä—Ç |
| `./restore_mongodb.sh` | –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞ |

---

## üåê API Endpoints

–í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–∏ endpoints –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –±—ç–∫–∞–ø–∞ –≤ —Å–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:

```bash
# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
curl http://localhost:8001/api/backup/stats

# –ü–æ–ª–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–π
curl http://localhost:8001/api/export/database > backup.json

# –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏
curl http://localhost:8001/api/export/collection/user_settings > user_settings.json
```

**–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞:**
- `user_settings` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `user_stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `user_achievements` - –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
- `tasks` - –ª–∏—á–Ω—ã–µ –∑–∞–¥–∞—á–∏
- `rooms` - –∫–æ–º–Ω–∞—Ç—ã
- `room_participants` - —É—á–∞—Å—Ç–Ω–∏–∫–∏ –∫–æ–º–Ω–∞—Ç
- `group_tasks` - –≥—Ä—É–ø–ø–æ–≤—ã–µ –∑–∞–¥–∞—á–∏

---

## üí° –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±—ç–∫–∞–ø
```bash
# –î–æ–±–∞–≤–∏—Ç—å –≤ crontab
crontab -e

# –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É (–±—ç–∫–∞–ø –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 3:00 AM):
0 3 * * * /app/backup_mongodb.sh >> /var/log/mongodb_backup.log 2>&1
```

### –ü—Ä–∏–º–µ—Ä 2: –ë—ç–∫–∞–ø –ø–µ—Ä–µ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
```bash
# –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø
./backup_mongodb.sh

# –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
git pull
sudo supervisorctl restart all

# –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫ - –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
./restore_mongodb.sh /app/backups/LATEST_BACKUP_binary/rudn_schedule
```

### –ü—Ä–∏–º–µ—Ä 3: –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ –¥—Ä—É–≥–æ–π —Å–µ—Ä–≤–µ—Ä
```bash
# –ù–∞ —Å—Ç–∞—Ä–æ–º —Å–µ—Ä–≤–µ—Ä–µ
./download_backup.sh
cat /app/api_backups/database_backup_*.json | base64 > backup.txt

# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å backup.txt –Ω–∞ –Ω–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä

# –ù–∞ –Ω–æ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ
cat backup.txt | base64 -d > backup.json
# –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ MongoDB
mongoimport --uri="mongodb://localhost:27017/rudn_schedule" --file=backup.json
```

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –ë—ã—Å—Ç—Ä–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
```bash
curl -s http://localhost:8001/api/backup/stats | python3 -m json.tool
```

### –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —á–µ—Ä–µ–∑ MongoDB:
```bash
mongosh mongodb://localhost:27017/rudn_schedule --eval "
  print('–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: rudn_schedule');
  print('–ö–æ–ª–ª–µ–∫—Ü–∏–π: ' + db.getCollectionNames().length);
  print('');
  print('–î–æ–∫—É–º–µ–Ω—Ç—ã –ø–æ –∫–æ–ª–ª–µ–∫—Ü–∏—è–º:');
  db.getCollectionNames().forEach(function(col) {
    print('  ' + col + ': ' + db[col].countDocuments());
  });
  print('');
  var stats = db.stats();
  print('–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö: ' + (stats.dataSize / 1024 / 1024).toFixed(2) + ' MB');
  print('–†–∞–∑–º–µ—Ä –Ω–∞ –¥–∏—Å–∫–µ: ' + (stats.storageSize / 1024 / 1024).toFixed(2) + ' MB');
"
```

---

## ‚ùì FAQ

**Q: –ö–∞–∫ —á–∞—Å—Ç–æ –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å –±—ç–∫–∞–ø?**  
A: –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:
- –ü–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ï–∂–µ–¥–Ω–µ–≤–Ω–æ, –µ—Å–ª–∏ –º–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ –¥–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤

**Q: –ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—å –±—ç–∫–∞–ø—ã?**  
A: –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏:
- –õ–æ–∫–∞–ª—å–Ω—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- –û–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (Google Drive, Dropbox)
- –û—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä
- –ù–ï —Ö—Ä–∞–Ω–∏—Ç–µ —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è!

**Q: –ö–∞–∫–æ–π —Å–ø–æ—Å–æ–± –±—ç–∫–∞–ø–∞ –≤—ã–±—Ä–∞—Ç—å?**  
A: 
- –ù–æ–≤–∏—á–∫–∞–º: `./download_backup.sh` (—Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π)
- –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–∞–º: `./backup_mongodb.sh` (–ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å)
- –î–ª—è –º–∏–≥—Ä–∞—Ü–∏–π: `./export_json.sh` (–ª–µ–≥–∫–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å)

**Q: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—É—Å—Ç–∞—è, —á—Ç–æ –¥–µ–ª–∞—Ç—å?**  
A: –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –Ω–æ–≤–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ë—ç–∫–∞–ø –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç, –¥–∞–∂–µ —Å –ø—É—Å—Ç–æ–π –±–∞–∑–æ–π.

**Q: –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –±—ç–∫–∞–ø —Ä–∞–±–æ—Ç–∞–µ—Ç?**  
A: –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ, —Å–¥–µ–ª–∞–π—Ç–µ –±—ç–∫–∞–ø, —É–¥–∞–ª–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏–∑ –±—ç–∫–∞–ø–∞.

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ù–µ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–π—Ç–µ** –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `MONGO_URL` –≤ —Ñ–∞–π–ª–µ `/app/backend/.env`
2. **–í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ** —Ä–∞–∑–º–µ—Ä –±—ç–∫–∞–ø–∞ –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏–π
3. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ** —Ö–æ—Ç—è –±—ã —Ä–∞–∑ –≤ –º–µ—Å—è—Ü
4. **–•—Ä–∞–Ω–∏—Ç–µ –º–∏–Ω–∏–º—É–º 3** –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –±—ç–∫–∞–ø–∞
5. **–®–∏—Ñ—Ä—É–π—Ç–µ –±—ç–∫–∞–ø—ã** –µ—Å–ª–∏ –æ–Ω–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

---

## üìû –ü–æ–ª—É—á–∏—Ç—å –ø–æ–º–æ—â—å

1. **–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** [README_BACKUP.md](./README_BACKUP.md)
2. **–®–ø–∞—Ä–≥–∞–ª–∫–∞:** [BACKUP_CHEATSHEET.md](./BACKUP_CHEATSHEET.md)
3. **–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:** [BACKUP_INSTRUCTIONS.md](./BACKUP_INSTRUCTIONS.md)

---

## ‚úÖ –†–µ–∑—é–º–µ

**–î–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å–ª—É—á–∞–µ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:**
```bash
./download_backup.sh
```

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç JSON –±—ç–∫–∞–ø –≤—Å–µ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–π –ª–µ–≥–∫–æ —Å–∫–∞—á–∞—Ç—å –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å.

**–í—Å–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üöÄ**

---

**–°–æ–∑–¥–∞–Ω–æ:** Emergent AI Agent  
**–î–∞—Ç–∞:** 2025-11-22  
**–ü—Ä–æ–µ–∫—Ç:** RUDN Schedule Telegram Web App
